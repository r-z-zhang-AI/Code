import pandas as pd
import re
from io import StringIO
import openpyxl

# Markdown 表格字符串
markdown_table = """
|序号|性别|年龄|职业|收入水平|得知渠道|购买情况|产品口味满意度|最喜欢产品|产品价格评价|产品更新速度评价|包装设计评价|服务态度评价|点单过程评价|制作速度评价|会员服务满意度|店内环境整洁度评价|店内氛围评价|座位数量评价|整体满意度|推荐意愿|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|1|女|18 - 25岁|学生|3000元以下|社交媒体|逛街时、想喝奶茶时随机选择|满意|芝士茗茶系列、满杯水果系列|适中|较快，能满足需求|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|2|男|26 - 35岁|上班族|5001 - 8000元|广告宣传、他人提及|工作 / 学习间隙、聚会|非常满意|波波家族系列、牛乳茶系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|3|女|18 - 25岁|自由职业者|3001 - 5000元|社交媒体、线下门店|逛街时、想喝奶茶时随机选择|一般|芝士茗茶系列、热饮系列|适中|一般，更新不频繁|一般，没有特别的感觉|一般，基本符合要求|一般，有时会遇到一些困扰|一般，等待时间适中|一般，会员服务没有特别的优势|一般，还可以进一步改善|一般，没有特别的感觉|勉强可以满足|一般|不确定|
|4|男|36 - 45岁|上班族|8001 - 12000元|广告宣传|工作 / 学习间隙|满意|波波家族系列|适中|较快，能满足需求|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|5|女|18岁以下|学生|3000元以下|他人提及|逛街时、聚会|满意|满杯水果系列、热饮系列|较便宜|一般，更新不频繁|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|6|男|26 - 35岁|个体户|12000元以上|社交媒体|工作 / 学习间隙、想喝奶茶时随机选择|非常满意|芝士茗茶系列、波波家族系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|7|女|46岁及以上|其他|3000元以下|线下门店|逛街时|不满意|满杯水果系列|太贵，难以接受|较慢，希望加快更新|不太好，有待改进|不太好，有待提高|不太顺畅，点单系统或流程有问题|较慢，等待时间较长|不满意，会员服务形同虚设|不太整洁，需要加强卫生管理|较差，氛围不够好|不能满足|不满意|可能不会|
|8|男|18 - 25岁|学生|3001 - 5000元|社交媒体|想喝奶茶时随机选择|满意|牛乳茶系列|适中|一般，更新不频繁|一般，没有特别的感觉|一般，基本符合要求|一般，有时会遇到一些困扰|一般，等待时间适中|一般，会员服务没有特别的优势|一般，还可以进一步改善|一般，没有特别的感觉|勉强可以满足|一般|不确定|
|9|女|26 - 35岁|上班族|5001 - 8000元|广告宣传|工作 / 学习间隙、聚会|非常满意|芝士茗茶系列、波波家族系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|10|男|36 - 45岁|上班族|8001 - 12000元|社交媒体|工作 / 学习间隙|满意|波波家族系列|适中|较快，能满足需求|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|11|女|18岁以下|学生|3000元以下|他人提及|逛街时、聚会|满意|满杯水果系列、热饮系列|较便宜|一般，更新不频繁|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|12|男|26 - 35岁|个体户|12000元以上|社交媒体|工作 / 学习间隙、想喝奶茶时随机选择|非常满意|芝士茗茶系列、波波家族系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|13|女|46岁及以上|其他|3000元以下|线下门店|逛街时|不满意|满杯水果系列|太贵，难以接受|较慢，希望加快更新|不太好，有待改进|不太好，有待提高|不太顺畅，点单系统或流程有问题|较慢，等待时间较长|不满意，会员服务形同虚设|不太整洁，卫生管理需加强|较差，氛围不够好|不能满足|不满意|可能不会|
|14|男|18 - 25岁|学生|3001 - 5000元|社交媒体|想喝奶茶时随机选择|满意|牛乳茶系列|适中|一般，更新不频繁|一般，没有特别的感觉|一般，基本符合要求|一般，有时会遇到一些困扰|一般，等待时间适中|一般，会员服务没有特别的优势|一般，还可以进一步改善|一般，没有特别的感觉|勉强可以满足|一般|不确定|
|15|女|26 - 35岁|上班族|5001 - 8000元|广告宣传|工作 / 学习间隙、聚会|非常满意|芝士茗茶系列、波波家族系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|16|男|36 - 45岁|上班族|8001 - 12000元|社交媒体|工作 / 学习间隙|满意|波波家族系列|适中|较快，能满足需求|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|17|女|18岁以下|学生|3000元以下|他人提及|逛街时、聚会|满意|满杯水果系列、热饮系列|较便宜|一般，更新不频繁|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|18|男|26 - 35岁|个体户|12000元以上|社交媒体|工作 / 学习间隙、想喝奶茶时随机选择|非常满意|芝士茗茶系列、波波家族系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|19|女|46岁及以上|其他|3000元以下|线下门店|逛街时|不满意|满杯水果系列|太贵，难以接受|较慢，希望加快更新|不太好，有待改进|不太好，有待提高|不太顺畅，点单系统或流程有问题|较慢，等待时间较长|不满意，会员服务形同虚设|不太整洁，卫生管理需加强|较差，氛围不够好|不能满足|不满意|可能不会|
|20|男|18 - 25岁|学生|3001 - 5000元|社交媒体|想喝奶茶时随机选择|满意|牛乳茶系列|适中|一般，更新不频繁|一般，没有特别的感觉|一般，基本符合要求|一般，有时会遇到一些困扰|一般，等待时间适中|一般，会员服务没有特别的优势|一般，还可以进一步改善|一般，没有特别的感觉|勉强可以满足|一般|不确定|
|21|女|26 - 35岁|上班族|5001 - 8000元|广告宣传|工作 / 学习间隙、聚会|非常满意|芝士茗茶系列、波波家族系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|22|男|36 - 45岁|上班族|8001 - 12000元|社交媒体|工作 / 学习间隙|满意|波波家族系列|适中|较快，能满足需求|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|23|女|18岁以下|学生|3000元以下|他人提及|逛街时、聚会|满意|满杯水果系列、热饮系列|较便宜|一般，更新不频繁|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|24|男|26 - 35岁|个体户|12000元以上|社交媒体|工作 / 学习间隙、想喝奶茶时随机选择|非常满意|芝士茗茶系列、波波家族系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|25|女|46岁及以上|其他|3000元以下|线下门店|逛街时|不满意|满杯水果系列|太贵，难以接受|较慢，希望加快更新|不太好，有待改进|不太好，有待提高|不太顺畅，点单系统或流程有问题|较慢，等待时间较长|不满意，会员服务形同虚设|不太整洁，卫生管理需加强|较差，氛围不够好|不能满足|不满意|可能不会|
|26|男|18 - 25岁|学生|3001 - 5000元|社交媒体|想喝奶茶时随机选择|满意|牛乳茶系列|适中|一般，更新不频繁|一般，没有特别的感觉|一般，基本符合要求|一般，有时会遇到一些困扰|一般，等待时间适中|一般，会员服务没有特别的优势|一般，还可以进一步改善|一般，没有特别的感觉|勉强可以满足|一般|不确定|
|27|女|26 - 35岁|上班族|5001 - 8000元|广告宣传|工作 / 学习间隙、聚会|非常满意|芝士茗茶系列、波波家族系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|28|男|36 - 45岁|上班族|8001 - 12000元|社交媒体|工作 / 学习间隙|满意|波波家族系列|适中|较快，能满足需求|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|29|女|18岁以下|学生|3000元以下|他人提及|逛街时、聚会|满意|满杯水果系列、热饮系列|较便宜|一般，更新不频繁|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|30|男|26 - 35岁|个体户|12000元以上|社交媒体|工作 / 学习间隙、想喝奶茶时随机选择|非常满意|芝士茗茶系列、波波家族系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|31|女|46岁及以上|其他|3000元以下|线下门店|逛街时|不满意|满杯水果系列|太贵，难以接受|较慢，希望加快更新|不太好，有待改进|不太好，有待提高|不太顺畅，点单系统或流程有问题|较慢，等待时间较长|不满意，会员服务形同虚设|不太整洁，卫生管理需加强|较差，氛围不够好|不能满足|不满意|可能不会|
|32|男|18 - 25岁|学生|3001 - 5000元|社交媒体|想喝奶茶时随机选择|满意|牛乳茶系列|适中|一般，更新不频繁|一般，没有特别的感觉|一般，基本符合要求|一般，有时会遇到一些困扰|一般，等待时间适中|一般，会员服务没有特别的优势|一般，还可以进一步改善|一般，没有特别的感觉|勉强可以满足|一般|不确定|
|33|女|26 - 35岁|上班族|5001 - 8000元|广告宣传|工作 / 学习间隙、聚会|非常满意|芝士茗茶系列、波波家族系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|34|男|36 - 45岁|上班族|8001 - 12000元|社交媒体|工作 / 学习间隙|满意|波波家族系列|适中|较快，能满足需求|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|35|女|18岁以下|学生|3000元以下|他人提及
|51|女|26 - 35岁|上班族|5001 - 8000元|广告宣传、社交媒体|工作 / 学习间隙、逛街时|满意|芝士茗茶系列、满杯水果系列|适中|较快，能满足需求|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|52|男|36 - 45岁|个体户|8001 - 12000元|他人提及、线下门店|聚会、想喝奶茶时随机选择|非常满意|波波家族系列、牛乳茶系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|53|女|18 - 25岁|学生|3001 - 5000元|社交媒体|逛街时、想喝奶茶时随机选择|一般|芝士茗茶系列、热饮系列|适中|一般，更新不频繁|一般，没有特别的感觉|一般，基本符合要求|一般，有时会遇到一些困扰|一般，等待时间适中|一般，会员服务没有特别的优势|一般，还可以进一步改善|一般，没有特别的感觉|勉强可以满足|一般|不确定|
|54|男|26 - 35岁|上班族|5001 - 8000元|广告宣传|工作 / 学习间隙、聚会|非常满意|波波家族系列|适中|较快，能满足需求|比较新颖，感觉不错|热情，比较专业|非常顺畅，操作简单|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|55|女|18岁以下|学生|3000元以下|他人提及|逛街时、聚会|满意|满杯水果系列、热饮系列|较便宜|一般，更新不频繁|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|56|男|36 - 45岁|上班族|8001 - 12000元|社交媒体|工作 / 学习间隙|满意|波波家族系列|适中|较快，能满足需求|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|57|女|46岁及以上|其他|3000元以下|线下门店|逛街时|不满意|满杯水果系列|太贵，难以接受|较慢，希望加快更新|不太好，有待改进|不太好，有待提高|不太顺畅，点单系统或流程有问题|较慢，等待时间较长|不满意，会员服务形同虚设|不太整洁，需要加强卫生管理|较差，氛围不够好|不能满足|不满意|可能不会|
|58|男|18 - 25岁|学生|3001 - 5000元|社交媒体|想喝奶茶时随机选择|满意|牛乳茶系列|适中|一般，更新不频繁|一般，没有特别的感觉|一般，基本符合要求|一般，有时会遇到一些困扰|一般，等待时间适中|一般，会员服务没有特别的优势|一般，还可以进一步改善|一般，没有特别的感觉|勉强可以满足|一般|不确定|
|59|女|26 - 35岁|上班族|5001 - 8000元|广告宣传|工作 / 学习间隙、聚会|非常满意|芝士茗茶系列、波波家族系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|60|男|36 - 45岁|上班族|8001 - 12000元|社交媒体|工作 / 学习间隙|满意|波波家族系列|适中|较快，能满足需求|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|61|女|18岁以下|学生|3000元以下|他人提及|逛街时、聚会|满意|满杯水果系列、热饮系列|较便宜|一般，更新不频繁|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|62|男|26 - 35岁|个体户|12000元以上|社交媒体|工作 / 学习间隙、想喝奶茶时随机选择|非常满意|芝士茗茶系列、波波家族系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|63|女|46岁及以上|其他|3000元以下|线下门店|逛街时|不满意|满杯水果系列|太贵，难以接受|较慢，希望加快更新|不太好，有待改进|不太好，有待提高|不太顺畅，点单系统或流程有问题|较慢，等待时间较长|不满意，会员服务形同虚设|不太整洁，卫生管理需加强|较差，氛围不够好|不能满足|不满意|可能不会|
|64|男|18 - 25岁|学生|3001 - 5000元|社交媒体|想喝奶茶时随机选择|满意|牛乳茶系列|适中|一般，更新不频繁|一般，没有特别的感觉|一般，基本符合要求|一般，有时会遇到一些困扰|一般，等待时间适中|一般，会员服务没有特别的优势|一般，还可以进一步改善|一般，没有特别的感觉|勉强可以满足|一般|不确定|
|65|女|26 - 35岁|上班族|5001 - 8000元|广告宣传|工作 / 学习间隙、聚会|非常满意|芝士茗茶系列、波波家族系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|66|男|36 - 45岁|上班族|8001 - 12000元|社交媒体|工作 / 学习间隙|满意|波波家族系列|适中|较快，能满足需求|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|67|女|18岁以下|学生|3000元以下|他人提及|逛街时、聚会|满意|满杯水果系列、热饮系列|较便宜|一般，更新不频繁|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|68|男|26 - 35岁|个体户|12000元以上|社交媒体|工作 / 学习间隙、想喝奶茶时随机选择|非常满意|芝士茗茶系列、波波家族系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|69|女|46岁及以上|其他|3000元以下|线下门店|逛街时|不满意|满杯水果系列|太贵，难以接受|较慢，希望加快更新|不太好，有待改进|不太好，有待提高|不太顺畅，点单系统或流程有问题|较慢，等待时间较长|不满意，会员服务形同虚设|不太整洁，卫生管理需加强|较差，氛围不够好|不能满足|不满意|可能不会|
|70|男|18 - 25岁|学生|3001 - 5000元|社交媒体|想喝奶茶时随机选择|满意|牛乳茶系列|适中|一般，更新不频繁|一般，没有特别的感觉|一般，基本符合要求|一般，有时会遇到一些困扰|一般，等待时间适中|一般，会员服务没有特别的优势|一般，还可以进一步改善|一般，没有特别的感觉|勉强可以满足|一般|不确定|
|71|女|26 - 35岁|上班族|5001 - 8000元|广告宣传|工作 / 学习间隙、聚会|非常满意|芝士茗茶系列、波波家族系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|72|男|36 - 45岁|上班族|8001 - 12000元|社交媒体|工作 / 学习间隙|满意|波波家族系列|适中|较快，能满足需求|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|73|女|18岁以下|学生|3000元以下|他人提及|逛街时、聚会|满意|满杯水果系列、热饮系列|较便宜|一般，更新不频繁|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|74|男|26 - 35岁|个体户|12000元以上|社交媒体|工作 / 学习间隙、想喝奶茶时随机选择|非常满意|芝士茗茶系列、波波家族系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|75|女|46岁及以上|其他|3000元以下|线下门店|逛街时|不满意|满杯水果系列|太贵，难以接受|较慢，希望加快更新|不太好，有待改进|不太好，有待提高|不太顺畅，点单系统或流程有问题|较慢，等待时间较长|不满意，会员服务形同虚设|不太整洁，卫生管理需加强|较差，氛围不够好|不能满足|不满意|可能不会|
|76|男|18 - 25岁|学生|3001 - 5000元|社交媒体|想喝奶茶时随机选择|满意|牛乳茶系列|适中|一般，更新不频繁|一般，没有特别的感觉|一般，基本符合要求|一般，有时会遇到一些困扰|一般，等待时间适中|一般，会员服务没有特别的优势|一般，还可以进一步改善|一般，没有特别的感觉|勉强可以满足|一般|不确定|
|77|女|26 - 35岁|上班族|5001 - 8000元|广告宣传|工作 / 学习间隙、聚会|非常满意|芝士茗茶系列、波波家族系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|78|男|36 - 45岁|上班族|8001 - 12000元|社交媒体|工作 / 学习间隙|满意|波波家族系列|适中|较快，能满足需求|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|79|女|18岁以下|学生|3000元以下|他人提及|逛街时、聚会|满意|满杯水果系列、热饮系列|较便宜|一般，更新不频繁|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|80|男|26 - 35岁|个体户|12000元以上|社交媒体|工作 / 学习间隙、想喝奶茶时随机选择|非常满意|芝士茗茶系列、波波家族系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|81|女|46岁及以上|其他|3000元以下|线下门店|逛街时|不满意|满杯水果系列|太贵，难以接受|较慢，希望加快更新|不太好，有待改进|不太好，有待提高|不太顺畅，点单系统或流程有问题|较慢，等待时间较长|不满意，会员服务形同虚设|不太整洁，卫生管理需加强|较差，氛围不够好|不能满足|不满意|可能不会|
|82|男|18 - 25岁|学生|3001 - 5000元|社交媒体|想喝奶茶时随机选择|满意|牛乳茶系列|适中|一般，更新不频繁|一般，没有特别的感觉|一般，基本符合要求|一般，有时会遇到一些困扰|一般，等待时间适中|一般，会员服务没有特别的优势|一般，还可以进一步改善|一般，没有特别的感觉|勉强可以满足|一般|不确定|
|83|女|26 - 35岁|上班族|5001 - 8000元|广告宣传|工作 / 学习间隙、聚会|非常满意|芝士茗茶系列、波波家族系列|有点贵，但可以接受|非常快，总能有新口味|非常新颖、美观，很吸引人|非常热情、专业|非常顺畅，操作简单|非常快，无需等待太久|非常满意，会员权益丰富|非常整洁，卫生状况良好|非常好，氛围舒适，有特色|完全可以满足|非常满意|一定会|
|84|男|36 - 45岁|上班族|8001 - 12000元|社交媒体|工作 / 学习间隙|满意|波波家族系列|适中|较快，能满足需求|比较新颖，感觉不错|热情，比较专业|比较顺畅，偶尔有小问题|较快，在可接受范围内|满意，能享受到一定的优惠和服务|比较整洁，基本符合要求|较好，能营造出不错的消费氛围|基本可以满足|满意|可能会|
|85|女|18岁以下|学生|3000元以下|他人提及|逛街时、聚会|满意|满杯水果系列、热饮系列|较便宜|一般，更新不频繁|比较新颖，感觉不错|热情，比较
"""

# 将 Markdown 转换为 DataFrame
def markdown_to_dataframe(markdown):
    # 去掉 Markdown 的表头和分隔符
    table = re.sub(r'\|[ ]?[-| ]+([ ]?\|)', '', markdown.strip())
    # 拆分行
    rows = table.split("\n")
    # 提取列名
    columns = [col.strip() for col in rows[0].split("|")[1:-1]]
    # 提取表格数据
    data_quantized = []
    for row in rows[1:]:
        data_quantized.append([col.strip() for col in row.split("|")[1:-1]])

    # 创建 DataFrame
    df = pd.DataFrame(data_quantized, columns=columns)
    return df

# 替换规则
def quantize_data(df):
    mappings = {
        '性别': {'女': 1, '男': 2},
        '年龄': {'18岁以下': 1, '18 - 25岁': 2, '26 - 35岁': 3, '36 - 45岁': 4, '46岁及以上': 5},
        '职业': {'学生': 1, '上班族': 2, '自由职业者': 3, '个体户': 4, '其他': 5},
        '收入水平': {'3000元以下': 1, '3001 - 5000元': 2, '5001 - 8000元': 3, '8001 - 12000元': 4, '12000元以上': 5},
        '得知渠道': {'社交媒体': 1, '广告宣传': 2, '他人提及': 3, '线下门店': 4},
        '购买情况': {
            '想喝奶茶时随机选择': 1, '工作 / 学习间隙': 2, '聚会': 3, '逛街时': 4, '逛街时、聚会': 5,
            '逛街时、想喝奶茶时随机选择': 6, '工作 / 学习间隙、聚会': 7, '工作 / 学习间隙、想喝奶茶时随机选择': 8
        },
        '产品口味满意度': {'不满意': 1, '一般': 2, '满意': 3, '非常满意': 4},
        '服务态度评价': {'非常热情、专业': 1, '热情，比较专业': 2, '一般，基本符合要求': 3, '不太好，有待提高': 4, '很差，需要改进': 5},
        '整体满意度': {'非常满意': 1, '满意': 2, '一般': 3, '不满意': 4, '非常不满意': 5},
        '产品价格评价': {'便宜': 1, '较便宜': 2, '适中': 3, '有点贵，但可以接受': 4, '太贵，难以接受': 5},
        '产品更新速度评价': {'非常快，总能有新口味': 1, '较快，能满足需求': 2, '一般，更新不频繁': 3, '较慢，希望加快更新': 4, '非常慢，很久没有新品': 5},
        '包装设计评价': {'非常新颖、美观，很吸引人': 1, '比较新颖，感觉不错': 2, '一般，没有特别的感觉': 3, '不太好，有待改进': 4, '很差，需要重新设计': 5},
        '点单过程评价': {'非常顺畅，操作简单': 1, '比较顺畅，偶尔有小问题': 2, '一般，有时会遇到一些困扰': 3, '不太顺畅，点单系统或流程有问题': 4, '非常不顺畅，影响消费体验': 5},
        '制作速度评价': {'非常快，无需等待太久': 1, '较快，在可接受范围内': 2, '一般，等待时间适中': 3, '较慢，等待时间较长': 4, '非常慢，难以忍受': 5},
        '会员服务满意度': {'非常满意，会员权益丰富': 1, '满意，能享受到一定的优惠和服务': 2, '一般，会员服务没有特别的优势': 3, '不满意，会员服务形同虚设': 4, '非常不满意，没有必要成为会员': 5},
        '店内环境整洁度评价': {'非常整洁，卫生状况良好': 1, '比较整洁，基本符合要求': 2, '一般，还可以进一步改善': 3, '不太整洁，需要加强卫生管理': 4, '非常不整洁，影响消费心情': 5},
        '店内氛围评价': {'非常好，氛围舒适，有特色': 1, '较好，能营造出不错的消费氛围': 2, '一般，没有特别的感觉': 3, '较差，氛围不够好': 4, '非常差，需要改进': 5},
        '座位数量评价': {'完全可以满足': 1, '基本可以满足': 2, '勉强可以满足': 3, '不能满足': 4, '远远不能满足': 5},
        '推荐意愿': {'一定会': 1, '可能会': 2, '不确定': 3, '可能不会': 4, '一定不会': 5}
    }

    # 按照映射规则替换列的值
    for column, mapping in mappings.items():
        if column in df.columns:
            df[column] = df[column].map(mapping)

    # 处理多值列（例如 "最喜欢产品"）
    if '最喜欢产品' in df.columns:
        product_mapping = {
            '满杯水果系列': 1, '热饮系列': 2, '芝士茗茶系列': 3, '波波家族系列': 4, '牛乳茶系列': 5
        }
        df['最喜欢产品'] = df['最喜欢产品'].apply(
            lambda x: ','.join(str(product_mapping[prod]) for prod in str(x).split('、') if prod in product_mapping)
        )

    return df

# 将 Markdown 表格转换为 DataFrame
df = markdown_to_dataframe(markdown_table)

# 应用量化
data_quantized = quantize_data(df)

# 输出 DataFrame 到 Excel
data_quantized.to_excel("data_output.xlsx", index=False)

# 打开生成的 Excel 文件
wb = openpyxl.load_workbook("data_output.xlsx")
sheet = wb.active

# 设置列宽，根据内容自适应
for column in sheet.iter_cols():
    max_length = 0
    for cell in column:
        try:
            if len(str(cell.value)) > max_length:
                max_length = len(str(cell.value))
        except:
            pass
    adjusted_width = (max_length + 2)
    sheet.column_dimensions[cell.column_letter].width = adjusted_width

# 保存修改
wb.save("data_output.xlsx")

print("文件data_output.xlsx已生成")
